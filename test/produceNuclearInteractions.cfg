process prod = {

 # initialize  MessageLogger
# include "FWCore/MessageLogger/data/MessageLogger.cfi"

  service =  RandomNumberGeneratorService {
#	untracked uint32 sourceSeed = 123456789
# This is to initialize the random engine of Famos
# Watch out! This works only if the FamosProducer label is "Famos"
        PSet moduleSeeds = {
#          	untracked uint32 VtxSmeared = 123456789
		untracked uint32 famosSimHits = 13579
#		untracked uint32 siTrackerGaussianSmearingRecHits = 24680
        }
}
	
  service = DaqMonitorROOTBackEnd{}		

 # input
  source = PoolSource {
#     untracked uint32 skipEvents = 476
     untracked int32 maxEvents = 10000
     untracked uint32 debugVebosity = 10
     untracked bool   debugFlag     = true
     untracked vstring fileNames = {
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/006FEF67-85A4-DB11-804B-001731A2845B.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/025CECDF-71A4-DB11-80CD-003048767D43.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/188B7490-A3A4-DB11-894C-00304875A7AF.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/1A5841C5-96A4-DB11-8263-00304870DEC9.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/1ADDB739-7CA4-DB11-8509-00304876A0DB.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/2228FEBE-94A4-DB11-8D51-001731AF6785.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/2441CF2E-89A4-DB11-8A56-00304875AADF.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/2668F5E2-94A4-DB11-86C1-001731A2845B.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/2E80252C-92A4-DB11-9D20-001731AF6727.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/2EB35FE0-93A4-DB11-9C76-003048767D4D.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/303A1180-96A4-DB11-928E-001731AF685D.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/349518EB-92A4-DB11-856E-00304875AA55.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/3672B439-92A4-DB11-8738-001731AF68CF.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/36C80DEB-95A4-DB11-8307-00304875AAEF.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/388011C6-93A4-DB11-9011-001731A28A73.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/3A4A92A4-8BA4-DB11-8D97-003048767DDD.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/3E7B45F9-85A4-DB11-989F-00304875A33F.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/442F67DC-76A4-DB11-954C-001731AF6653.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/4615058D-6DA4-DB11-90C5-001731AF66F7.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/4E1A9278-7EA4-DB11-9125-001731AF6993.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/4E70B87B-95A4-DB11-8206-003048756485.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/50253CA5-77A4-DB11-9494-003048767ED3.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/5273BA36-8BA4-DB11-8BB4-00304876A0FF.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/52ABC56C-94A4-DB11-8DAF-003048754D03.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/52D09565-92A4-DB11-8237-003048767DFB.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/5C2D38F7-6FA4-DB11-8745-003048758A07.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/6081E05C-96A4-DB11-873F-001731AF66B1.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/62DDF8C5-84A4-DB11-9B76-001731AF699D.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/64679FFB-94A4-DB11-9E95-003048767DC7.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/66495F52-95A4-DB11-8355-00304875A33F.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/68CFC0DE-92A4-DB11-991D-003048769E6F.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/6AF8B1E0-92A4-DB11-98B1-003048767CEF.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/70360F1C-93A4-DB11-8767-001731AF68B1.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/76B155F1-96A4-DB11-84D5-001731A28999.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/78E05815-8FA4-DB11-9597-001731AF67E1.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/7A162393-B9A4-DB11-8AAB-00304870D529.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/7C083D29-93A4-DB11-94BB-001731AF67E1.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/7CBC7B91-83A4-DB11-93D0-001731AF67B5.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/80C37870-74A4-DB11-8F2C-003048767ED3.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/8234C597-7EA4-DB11-9704-001731A28319.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/88D87774-95A4-DB11-9D74-003048767E63.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/96369AFF-80A4-DB11-985F-001731AF67C3.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/A0E10B91-96A4-DB11-9F32-00304870D647.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/A21C8399-93A4-DB11-941D-003048767DDD.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/A65081F3-8AA4-DB11-9AF2-001731AF6A8D.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/AC237EE1-94A4-DB11-9CF1-001731A28A31.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/AEF991B1-92A4-DB11-817F-001731AF6A8D.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/B43A6DA4-96A4-DB11-8462-003048769E89.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/BEE9E52D-95A4-DB11-9BF3-0030487253A7.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/C2287A3D-86A4-DB11-850A-003048756485.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/C2F05E53-B9A4-DB11-933E-001731A283E1.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/C85A3C4F-70A4-DB11-8723-00304876A067.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/CE51914D-93A4-DB11-972D-00304875A7AF.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/CE89A70B-96A4-DB11-8956-00304870DAFB.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/CEEB71ED-9BA4-DB11-8C9F-00304876A0D9.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/D2931252-68A4-DB11-9728-001731AF68B1.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/D29406C8-93A4-DB11-965F-00304875AB55.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/D2A8826A-93A4-DB11-95EF-003048767E5D.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/D6FA54AA-94A4-DB11-90AA-001731AF6B7D.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/E05F1025-90A4-DB11-8B1A-001731AF6787.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/E48D32E7-65A4-DB11-8448-001731AF66FB.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/E8E789AE-8EA4-DB11-8937-001731AF685D.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/EAD3D2EB-65A4-DB11-939A-001731AF67E1.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/EE34C24A-94A4-DB11-8239-001731AF67E7.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/F078714B-80A4-DB11-85B4-001731AF66A9.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/F092246F-94A4-DB11-94A3-001731AF67C3.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/F0E48F05-96A4-DB11-8A9A-003048767D6D.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/F20C1380-96A4-DB11-9203-001731AF66A7.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/F2524EC7-B4A4-DB11-80F8-001731AF6787.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/F8D7FFC1-9BA4-DB11-8FDA-00304876A0FF.root',
	'/store/mc/2006/12/26/mc-hcal-120_Ieta1-29_Iphi1-2_E015/0000/FE2389D0-84A4-DB11-9447-003048769D4D.root'
     }
}
  # The particle data table
    include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"   
    es_prefer = PythiaPDTESSource {}
	

   #Geometry
   include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"

   #Tracker geometry
   es_module = TrackerGeometricDetESModule {}
   include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
   include "RecoTracker/GeometryESProducer/data/TrackerRecoGeometryESProducer.cfi"

   #Magnetic Field
   #
   include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

   # Calo geometry service model
   include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"
   include "Geometry/CaloEventSetup/data/CaloTopology.cfi"		

#   module o1 = PoolOutputModule { untracked string fileName = "test.root" }
   module famosSimHits = FamosProducer 
   { 
	untracked int32 RunNumber = 1001
	bool UseMagneticField = true
	bool SimulatePileUp = false
	bool SimulateTracking = false
	bool SimulateCalorimetry = false
	untracked int32 Verbosity = 0

# Gaussian or flat or no primary vertex smearing
#	include "FastSimulation/Event/data/GaussianVertexGenerator.cfi"
#	include "FastSimulation/Event/data/FlatVertexGenerator.cfi"
	include "FastSimulation/Event/data/NoVertexGenerator.cfi"

# Kinematic cuts for the particle filter in the SimEvent
	include "FastSimulation/Event/data/ParticleFilter.cfi"

# Material effects to be simulated in the tracker material and associated cuts
	include "FastSimulation/MaterialEffects/data/MaterialEffects.cfi"


# (De)activate decays of unstable particles (K0S, etc...)
	include "FastSimulation/TrajectoryManager/data/ActivateDecays.cfi"

# Conditions to save Tracker SimHits 
	include "FastSimulation/TrajectoryManager/data/TrackerSimHits.cfi"

# FastCalorimetry
	include "FastSimulation/Calorimetry/data/Calorimetry.cfi"


# PileUp Event Generation
#	include "FastSimulation/PileUpProducer/data/PUProducer.cfi"

# Take pileup events from files
	PSet NUProducer = 
	{
	}


   }
   replace famosSimHits.MaterialEffects.NuclearInteraction=false

#  service = SimpleProfiling { }

  module prodNU = testNuclearInteractions
	{
	# module label to find input sim tracks and sim vertices
  # necessary to access true particles 
	PSet TestVertexGenerator = {	
		string type = "None"	
	}	

    	PSet TestParticleFilter = {
		# Particles with |eta| > etaMax (momentum direction at primary vertex) 
		# are not simulated 
       		double etaMax = 5.0
		# Charged particles with pT < pTMin (GeV/c) are not simulated
        	double pTMin =  0.
		# Particles with energy smaller than EMin (GeV) are not simulated
        	double EMin = 0.
    	}
	
	}

  module NUfilter = NuclearInteractionFilter 
	{
		PSet FilterVertexGenerator = {	
			string type = "None"	
		}		

	    	PSet FilterParticleFilter = {
			# Particles with |eta| > etaMax (momentum direction at primary vertex) 
			# are not simulated 
	       		double etaMax = 5.0
			# Charged particles with pT < pTMin (GeV/c) are not simulated
        		double pTMin =  0.
			# Particles with energy smaller than EMin (GeV) are not simulated
        		double EMin = 0.
   	 	}
	}

  # path to run everything
  path pf = { NUfilter }
  path p = { NUfilter, famosSimHits, prodNU }

  # output module
  module o2 = PoolOutputModule
  {
     untracked string fileName = "NuclearInteractionsFromPion_15GeV.root"
     untracked vstring outputCommands = {
	"drop *",
	"keep SimTracks_prodNU_*_*"
     }

     untracked PSet SelectEvents = {
         vstring SelectEvents = { "pf" }
     }
  }

  endpath outpath = { o2 }


}
